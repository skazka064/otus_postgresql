# Написание запросов с различными типами соединений
### Будем использовать следующую базу otus_ddl
```sql
CREATE DATABASE otus_dql;
```
### Создадим таблицы
```sql
CREATE TABLE buses (
    bus_id serial,
    name   varchar
);
CREATE TABLE drivers (
    driver_id   serial,
    first_name  varchar,
    second_name varchar
);


CREATE TABLE routes (
    route_id  serial,
    name      varchar,
    bus_id    int,
    driver_id int
);
```
### Заполним таблицы данными
```sql
INSERT INTO buses
       (bus_id, name)
VALUES (1, 'ПАЗ'),
       (2, 'ЛИАЗ'),
       (3, 'MAN'),
       (4, 'МАЗ'),
       (5, 'НЕФАЗ');

INSERT INTO drivers
       (driver_id, first_name, second_name)
VALUES (1, 'Иван', 'Иванов'),
       (2, 'Петр', 'Петров'),
       (3, 'Савелий', 'Сидоров'),
       (4, 'Антон', 'Шторкин'),
       (5, 'Олег', 'Зажигаев'),
       (6, 'Аркадий', 'Паровозов');

INSERT INTO routes
       (route_id, name, bus_id, driver_id)
VALUES (1, 'Москва-Болшево', 1, 1),
       (2, 'Москва-Пушкино', 1, 2),
       (3, 'Москва-Ярославль', 2, 3),
       (4, 'Москва-Кострома', 2, 4),
       (5, 'Москва-Волгорад', 3, 5),
       (6, 'Москва-Иваново', null, null);

```

![Маршруты и водители](/img/Screenshot_3.png "Маршруты и водители")


```sql
SELECT * FROM buses;
```

 <table>
    <tr>
    <th>bus_id</th>	<th>name</th>
    </tr>
    <tr>
    <td>1</td>	<td>ПАЗ</td>
    </tr>
    <tr>
    <td>2</td>	<td>ЛИАЗ</td>
    </tr>
    <tr>
    <td>3</td>	<td>MAN</td>
    </tr>
    <tr>
    <td>4</td>	<td>МАЗ</td>
    </tr>
    <tr>
    <td>5</td>	<td>НЕФАЗ</td>
    </tr>
 </table>  
 
```sql
SELECT * FROM drivers;
```
 <table>
    <tr>
    <th>driver_id</th>	<th>First_name</th><th>Second_name</th>
    </tr>
    <tr>
    <td>1</td>	<td>Иван</td><td>Иванов</td>
    </tr>
    <tr>
    <td>2</td>	<td>Петр</td><td>Петров</td>
    </tr>
    <tr>
    <td>3</td>	<td>Савелий</td><td>Сидоров</td>
    </tr>
    <tr>
    <td>4</td>	<td>Антон</td><td>Шторкин</td>
    </tr>
    <tr>
    <td>5</td>	<td>Олег</td><td>Зажигаев</td>
    </tr>
    <tr>
    <td>6</td>	<td>Аркадий</td><td>Паровозов</td>
    </tr>
 </table>

 ```sql
SELECT * FROM routes;
```
 <table>
    <tr>
    <th>route_id</th>	<th>name</th><th>bus_id</th><th>driver_id</th>
    </tr>
     <tr>
    <td>1</td>	<td>Москва-Болшево</td><td>1</td><td>1</td>
    </tr>
      <tr>
    <td>2</td>	<td>Москва-Пушкино</td><td>1</td><td>2</td>
    </tr>
      <tr>
    <td>3</td>	<td>Москва-Ярославль</td><td>2</td><td>3</td>
    </tr>
      <tr>
    <td>4</td>	<td>Москва-Кострома</td><td>2</td><td>4</td>
    </tr>
      <tr>
    <td>5</td>	<td>Москва-Волгорад</td><td>3</td><td>5</td>
    </tr>
      <tr>
    <td>6</td>	<td>Москва-Иваново</td><td>null</td><td>null</td>
    </tr>
 </table>


     
1. Реализовать прямое соединение двух или более таблиц
   - прямое соединение- это INNER JOIN. INNER в большинстве случаев опускается

```sql
    SELECT * FROM routes r
    JOIN buses b ON r.bus_id = b.bus_id
    JOIN drivers d on r.driver_id = d.driver_id;

    SELECT * FROM routes r, buses b, drivers d
    WHERE r.bus_id = b.bus_id
    AND d.driver_id=r.driver_id ;
```
