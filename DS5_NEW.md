# Начало
### развернуть виртуальную машину любым удобным способом
### поставить на неё PostgreSQL 15 любым способом
### настроить кластер PostgreSQL 15 на максимальную производительность не обращая внимание на возможные проблемы с надежностью в случае аварийной перезагрузки виртуальной машины
## настройки параметров по умолчанию такие:
```sql
postgres=# show work_mem;
 work_mem
----------
 4MB
(1 row)
```
#### используется для сортировок, построения хэш таблиц. Это позволяет выполнять данные операции в памяти, что гораздо быстрее обращений к диску. В рамках одного запроса данный параметр может быть использован много раз. Если ваш запрос содержит пять операций сортировки, то память которая потребуется для его выполнения как минимум 5*work_mem.  Так как, скорее всего на сервере вы не одни и сессий много, то каждая из них может использовать этот параметр по многу  раз, поэтому не рекомендуется делать его слишком большим. Можно выставить небольшое значение в глобальном конфиге, а в сессиях локально его менять(в случае сложных запросов).
```sql
postgres=# show effective_cache_size ;
 effective_cache_size
----------------------
 4GB
(1 row)
```
#### служит подсказкой для планировщика, сколько ОП у него в запасе. Можно определить как shared_buffers + ОП системы, т.е. ОП, используемое самой ОС и сторонними приложениями. За счет данного параметра планировщик чаще может использовать индексы. Наиболее часто используемое значение 75% от общей на сервере.
```sql
postgres=# show shared_buffers ;
 shared_buffers
----------------
 128MB
(1 row)
```
#### используется для кэширования данных. По умолчанию значение низкое- для поддержания большого количества ОС. Начать стоит с его изменения. Согласно документации, рекомендуемое значение для этого параметра 25% от общей оперативной памяти на сервере. Postgresql использует два кэша. Свой shared_buffers и ОС. Редко значение больше чем 40% окажет влияние на производительность.
```sql
postgres=# show max_connections ;
 max_connections
-----------------
 100
(1 row)
```
#### максимальное количество соединений. Для изменения параметра придется перезапускать сервер. Если пранируется использовать Postgresql как DWH то большого количества соединений не нужно. Данный параметр тесно связан с work_mem
```sql
postgres=# show maintenance_work_mem ;
 maintenance_work_mem
----------------------
 64MB
(1 row)
```
#### определяет максимальное количество ОП для операций VACUUM, CREATE INDEX, CREATE FOREGN KEY увеличение этого параметра позволит быстее выполнять эти операции. Не связано с work_mem , поэтому можно ставить в разы больше, чем work_mem


